---
title: "R Notebook"
output: html_notebook
---

```{r load_packages}
library(tidyverse)
library(tidymodels)
library(kknn)
library(tidytext)
library(textrecipes)
library(here)
library(moderndive)
library(ranger)
library(recipes)
library(rsample)
library(caret)
```


```{r set_style}
theme_set(theme_minimal())
scotblue <- "#0065BF"
ukred <- "#D00C27"
```


loading the processed data that have only all the feachers a nd the recomndation score.
```{r load_data}
data <- read_csv('Data/Data.csv', show_col_types = FALSE)
```
split the data to train and test

```{r split_data}
set.seed(1234)
data_split <- initial_split(data, strata = RECOMMENDATION)
trainl <- training(data_split)
test  <- testing(data_split)
```

set the  linear model 
```{r set_linear_model}
RECOMMENDATION_linear <- lm(RECOMMENDATION ~ IMPACT+SUBSTANCE+APPROPRIATENESS+MEANINGFUL_COMPARISON+SOUNDNESS_CORRECTNESS+
ORIGINALITY+CLARITY+REVIEWER_CONFIDENCE,data = train_all)

```


histogram of the predicton error
```{r}
model_points <- get_regression_points(RECOMMENDATION_all_model)
ggplot(model_points, aes(x = residual)) +
geom_histogram(bins = 50,color = "#000000", fill = "#0099F8") +
  labs(
    title = "Histogram of Recommendation Predicton of the linear model",
    x = "Recommendation Prediction Error",
    y = "Count"
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(color = "#0099F8", size = 16, face = "bold"),
    plot.subtitle = element_text(size = 10, face = "bold"),
    plot.caption = element_text(face = "italic")
  )
```



//Random Forest

```{r}
rf_mod <- rand_forest(mode="classification") %>%
  fit(as.factor(RECOMMENDATION) ~ IMPACT+SUBSTANCE+APPROPRIATENESS+MEANINGFUL_COMPARISON+SOUNDNESS_CORRECTNESS+
ORIGINALITY+CLARITY+REVIEWER_CONFIDENCE, train_all)


pred <- rf_mod %>% predict(test_all) %>% bind_cols(test_all %>% select(RECOMMENDATION))

pred
```




